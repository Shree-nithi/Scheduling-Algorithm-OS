"use strict";$(document).ready(function(){$("#explanation-equation").hide(),$(".priority").collapse({toggle:!1});var e="FCFS",l=0,i=0,c=[],r=2,o=3,a=0,s=new t;function n(){for(var e=0,t=0,r=0;r<c.length;r++)if(0==c[r].done&&c[r].arrivalTime<=a){t=c[e=r].burstTime;break}for(r=e;r<c.length;r++)c[r].burstTime<t&&0==c[r].done&&c[r].arrivalTime<=a&&(t=c[e=r].burstTime);return e}function d(){for(var e=0,t=0,r=0;r<c.length;r++)if(0==c[r].done&&c[r].arrivalTime<=a){t=c[e=r].priority;break}for(r=e;r<c.length;r++)c[r].priority<t&&0==c[r].done&&c[r].arrivalTime<=a&&(t=c[e=r].priority);return e}function h(){for(var e=!0,t=0;t<c.length;t++)0==c[t].done&&(e=!1);return e}function m(){for(var e=0;e<c.length;e++)if(0==c[e].done){c[e].arrivalTime>a&&s.addItem("idle",c[e].arrivalTime-a);break}}function t(){this.indexes=[],this.names=[],this.sum=0,this.addItem=function(e,t){var r=this.names[this.names.length-1];0<this.names.length&&r==e?(this.indexes[this.indexes.length-1]+=t,this.sum+=t,a+=t):(("idle"!=r&&"context switch"!=r&&"idle"!=e&&0!=a&&0<i||"idle"==e&&t<=i&&0!=a)&&(this.indexes[this.indexes.length]=i,this.names[this.names.length]="context switch",this.sum+=i,a+=i,a=parseFloat(a.toPrecision(12))),0==("idle"==e&&t<=i&&0!=a)&&(this.indexes[this.indexes.length]=t,this.names[this.names.length]=e,this.sum+=t,a+=t)),a=parseFloat(a.toPrecision(12)),this.sum=parseFloat(this.sum.toPrecision(12))},this.displayBar=function(){for(var e=0,t=0;t<this.indexes.length;t++){console.log("name:"+this.names[t]+"  index:"+this.indexes[t]);var r=this.indexes[t]/this.sum*100;f(this.names[t],r,e,this.indexes[t],t),e+=this.indexes[t],e=parseFloat(e.toPrecision(12))}v(this.sum),console.log("sum:"+this.sum+"   "+l);var i=100-(this.sum-l)/this.sum*100;i=Math.round(100*i)/100,c.sort(function(e,t){return e.pIndex>t.pIndex?1:e.pIndex<t.pIndex?-1:0});var s=[];s[0]=c[0].finishTime-c[0].arrivalTime-c[0].initialBurst,s[0]=parseFloat(s[0].toPrecision(12));var a="";a+='<p class="lead"> CPU utilization: $ '+i+'\\%   $<br><br>Average Wait Time: <span style="font-size:24px">$ \\frac{'+s[0];var o=s[0];for(t=1;t<c.length;t++)s[t]=c[t].finishTime-c[t].arrivalTime-c[t].initialBurst,s[t]=parseFloat(s[t].toPrecision(12)),a+="+"+s[t],o+=s[t];var n=o/c.length;n=Math.round(1e4*n)/1e4,a+="}{"+c.length+"} $</span> $ = "+n+" $",$("#explanation-equation").html(a),Preview.Update()}}function u(e,t,r,i,s){this.processName=e,this.burstTime=t,this.initialBurst=t,this.arrivalTime=r,this.done=!1,this.hasStarted=!1,this.finishTime,this.priority=s,this.pIndex=i,this.finished=function(){this.done=!0,this.finishTime=a,console.log(this.processName+" finished at position:"+a),console.log("wait time:"+(this.finishTime-this.arrivalTime-this.initialBurst))}}function p(){c.sort(function(e,t){return e.arrivalTime>t.arrivalTime?1:e.arrivalTime<t.arrivalTime?-1:0})}function f(e,t,r,i,s){var a=r+i;a=parseFloat(a.toPrecision(12)),0==$("#bar_"+s).length?$(".progress").append(" <div class='progress-bar' data-toggle='tooltip' title=' ' data-placement='right' id='bar_"+s+"' role='progressbar' >"+e+"</div>"):($("#bar_"+s).removeClass("progress-bar-idle"),$("#bar_"+s).removeClass("progress-bar-context"),$("#bar_"+s).removeClass("progress-bar-first"),$("#bar_"+s).removeClass("progress-bar-second"),$("#bar_"+s).removeClass("progress-bar-third"),$("#bar_"+s).removeClass("progress-bar-fourth"),$("#bar_"+s).removeClass("progress-bar-fifth")),"P1"==e?$("#bar_"+s).addClass("progress-bar-first"):"P2"==e?$("#bar_"+s).addClass("progress-bar-second"):"P3"==e?$("#bar_"+s).addClass("progress-bar-third"):"P4"==e?$("#bar_"+s).addClass("progress-bar-fourth"):"P5"==e?$("#bar_"+s).addClass("progress-bar-fifth"):"context switch"==e?$("#bar_"+s).addClass("progress-bar-context"):"idle"==e&&$("#bar_"+s).addClass("progress-bar-idle");var o=e,n=e;"idle"==e?(n="Idle CPU",o=""):"context switch"==e&&(n="Context Switch",o=""),$("#bar_"+s).attr("title",n+"\nStart: "+r+"\nDuration: "+i+"\nEnd: "+a),$("#bar_"+s).text(o),$("#bar_"+s).css("width",t+"%")}function g(){!function(){c=[];for(var e=l=0,t=0;t<o;t++){var r=Number($("#burst_"+(t+1)).val())+0;l+=r;var i=Number($("#arrive_"+(t+1)).val())+0,s="P"+(t+1),a=Number($("#priority_"+(t+1)).val())+0;0<r&&0==isNaN(i)&&(c[e]=new u(s,r,i,t,a),e++)}}(),0<c.length&&(p(),a=0,s=new t,"FCFS"==e?($("#algorithm_explanation").text("First Come First Served will execute proccesses in the order in which they arrived"),function(){p();for(var e=0;e<c.length;e++)m(),s.addItem(c[e].processName,c[e].burstTime),c[e].finished()}()):"SJF"==e?($("#algorithm_explanation").text("Shortest Job First will execute proccesses from smallest to biggest"),function(){for(p();0==h();){m();var e=n();s.addItem(c[e].processName,c[e].burstTime),c[e].finished()}}()):"SRJF"==e?(function(){function e(e){for(var t=!1,r=0;r<c.length;r++)if(0==c[r].done&&c[r].arrivalTime<a+c[e].burstTime&&c[r].arrivalTime>c[e].arrivalTime&&c[r].burstTime<c[e].burstTime&&r!=e&&0==c[r].hasStarted){console.log("interupted by:"+c[r].processName),c[e].burstTime-=c[r].arrivalTime-a,s.addItem(c[e].processName,c[r].arrivalTime-a),t=c[e].hasStarted=!0;break}0==t&&(s.addItem(c[e].processName,c[e].burstTime),c[e].finished())}for(p();0==h();){m();var t=n();console.log("starting:"+c[t].processName),e(t)}}(),$("#algorithm_explanation").text("Shortest Remaining Job First will execute proccesses from smallest to biggest. If a new proccess arrives that is smaller than the currently running proccess, it will interrupt it.")):"Round Robin"==e&&($("#algorithm_explanation").text("Round Robin will execute each proccess for the duration of the time quantum. It will then move on to the next proccess. "),function(){function e(e){for(;;){if(c[e].burstTime<=r&&0==c[e].done&&c[e].arrivalTime<=a)return s.addItem(c[e].processName,c[e].burstTime),c[e].finished(),console.log("finished:"+c[e].processName+"  postion:"+a),e=(e+1)%c.length;0==c[e].done&&c[e].arrivalTime<=a&&c[e].burstTime>r&&(console.log("switched to:"+c[e].processName),c[e].burstTime-=r,s.addItem(c[e].processName,r)),e=(e+1)%c.length}}var t=0;for(p();0==h();)m(),console.log("starting:"+c[t].processName),t=e(t)}()),"Priority"==e&&($(".priority").collapse("show"),$("#algorithm_explanation").text("Priority Scheduling will execute each process according to the assigned priority. In this case a lower priority number is better."),function(){function e(e){for(var t=!1,r=0;r<c.length;r++)if(0==c[r].done&&c[r].arrivalTime<a+c[e].burstTime&&c[r].arrivalTime>c[e].arrivalTime&&c[r].priority<c[e].priority&&r!=e&&0==c[r].hasStarted){console.log("interupted by:"+c[r].processName),c[e].burstTime-=c[r].arrivalTime-a,s.addItem(c[e].processName,c[r].arrivalTime-a),t=c[e].hasStarted=!0;break}0==t&&(s.addItem(c[e].processName,c[e].burstTime),c[e].finished())}for(p();0==h();){m();var t=d();console.log("starting:"+c[t].processName),e(t)}}()),s.displayBar())}function v(e){var t=1,r=" "+e;if(5e3<e){console.log("length:"+r.length);var i=Math.pow(10,r.length-2);e/=i,t=i}else 2500<e?(e/=100,t=100):1e3<e?(e/=50,t=50):500<e?(e/=25,t=25):100<e?(e/=10,t=10):50<e&&(e/=5,t=5);for(var s=0;s<e;s++){var a=$("#rule2").empty(),o=Number(e)||0,n=$(document.createElement("li"));$(n).addClass("zero"),a.append(n.text(0));for(var l=0;l<o;l++){n=$(document.createElement("li"));a.append(n.text((l+1)*t))}}var c=$(".progress").width()/e+"px";$(".ruler").css("padding-right",c).find("li").css("padding-left",c),$(".zero").css("padding-left",0),$(".zero").css("padding-right","0.5px")}g(),setTimeout(function(){g()},200),$("#add_row").click(function(){o++,$("#row_"+o).collapse("show"),$("#remove_row").prop("disabled",!1),5==o&&$("#add_row").prop("disabled",!0),g(),$("#proccess_num").val(o)}),$("#remove_row").click(function(){$("#row_"+o).collapse("hide"),o--,$("#add_row").prop("disabled",!1),1==o&&$("#remove_row").prop("disabled",!0),g(),$("#proccess_num").val(o)}),$("#subtract_context").click(function(){.1<=i&&(i-=.1,i=parseFloat(i.toPrecision(12))),g(),$("#enter_context").val(i)}),$("#add_context").click(function(){i+=.1,i=parseFloat(i.toPrecision(12)),g(),$("#enter_context").val(i)}),$("#subtract_quantum").click(function(){.5<r&&(r-=.5,r=parseFloat(r.toPrecision(12))),g(),$("#enter_quantum").val(r)}),$("#add_quantum").click(function(){r+=.5,r=parseFloat(r.toPrecision(12)),g(),$("#enter_quantum").val(r)}),$("#enter_quantum").on("input propertychange paste",function(){0==isNaN($(this).val())&&0!=$(this).val()&&(r=Number($(this).val())),g()}),$("#enter_context").on("input propertychange paste",function(){0==isNaN($(this).val())&&(i=Number($(this).val())),g()}),$("td input").on("input propertychange paste",function(){g()}),$(".algorithm_dropdown li a").click(function(){$("#algorithm_button").html($(this).attr("calcStyle")+' <span class="caret">'),"Round Robin"==(e=$(this).attr("calcStyle"))?$("#solver_group").removeClass("hidden"):$("#solver_group").addClass("hidden"),"Priority"!=e&&$(".priority").collapse("hide"),g()}),$(window).resize(function(){v(s.sum)})});
//# sourceMappingURL=cpu-scheduler.min.js.map
